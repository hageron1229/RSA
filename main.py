# coding: utf-8
from math import gcd
import random

class RSA:
	#使うfield涫メモ
	n = "-1"
	e = "-1"
	d = "-1"

	def __init__(self,pub="-1",pri="-1"):
		#がm切かは判断しない
		if pub!="-1" and pri!="-1" and pub[1]==pri[1]:
			self.e = pub[0]
			self.d = pri[0]
			self.n = pub[1]
			return

		#1秘密I、公_Iの作成
		#おしなので素数は用意した
		prime_list = [
			9947303,9947321,9947323,9947369,9947383,9947407,9947417,9947429,9947437,9947473,9947489,9947501,9947513,9947521,9947527,9947573,9947599,9947611,9947627,9947653,9947671,9947719,9947723,9947741,9947761,9947779,9947803,9947837,9947851,9947863,9947867,9947923,9947947,9947969,9947999,9948011,9948013,9948041,9948061,9948083,9948097,9948101,9948109,9948137,9948157,9948163,9948173,9948203,9948217,9948277,9948287,9948293,9948311,9948313,9948319,9948329,9948347,9948359,9948413,9948431,9948469,9948473,9948487,9948503,9948511,9948517,9948541,9948557,9948559,9948569,9948583,9948593,9948623,9948637,9948643,9948677,9948703,9948709,9948713,9948739,9948749,9948751,9948767,9948779,9948787,9948793,9948797,9948833,9948847,9948871,9948877,9948881,9948889,9948899,9948907,9948931,9948941,9948947,9948971,9948973,9948979,9949021,9949061,9949067,9949073,9949081,9949099,9949123,9949169,9949231,9949249,9949253,9949259,9949273,9949321,9949393,9949417,9949421,9949427,9949439,9949441,9949451,9949487,9949519,9949549,9949601,9949613,9949619,9949627,9949631,9949651,9949657,9949661,9949663,9949703,9949717,9949721,9949733,9949739,9949741,9949747,9949769,9949783,9949829,9949831,9949859,9949867,9949873,9949883,9949889,9949909,9949931,9949943,9949963,9949967,9950021,9950023,9950029,9950047,9950051,9950063,9950081,9950089,9950093,9950141,9950147,9950179,9950183,9950201,9950203,9950207,9950209,9950221,9950233,9950257,9950263,9950293,9950309,9950327,9950351,9950363,9950377,9950383,9950399,9950401,9950407,9950429,9950453,9950459,9950461,9950489,9950531,9950533,9950537,9950539,9950569,9950581,9950609,9950617,9950641,9950653,9950657,9950687,9950693,9950701,9950711,9950713,9950753,9950771,9950777,9950779,9950819,9950821,9950827,9950833,9950861,9950867,9950873,9950879,9950911,9950917,9950921,9950957,9950959,9950977,9950989,9951013,9951023,9951047,9951059,9951083,9951101,9951127,9951143,9951163,9951167,9951181,9951191,9951211,9951229,9951251,9951257,9951281,9951283,9951299,9951301,9951317,9951329,9951343,9951367,9951371,9951377,9951401,9951407,9951413,9951419,9951449,9951457,9951463,9951467,9951481,9951499,9951503,9951517,9951523,9951541,9951547,9951563,9951569,9951583,9951587,9951637,9951701,9951703,9951719,9951731,9951737,9951743,9951751,9951761,9951769,9951793,9951829,9951841,9951869,9951883,9951911,9951913,9951917,9951973,9952037,9952039,9952043,9952057,9952087,9952093,9952099,9952121,9952127,9952153,9952213,9952253,9952273,9952277,9952289,9952303,9952337,9952339,9952343,9952351,9952357,9952363,9952367,9952403,9952417,9952421,9952427,9952441,9952469,9952471,9952483,9952489,9952493,9952513,9952541,9952549,9952559,9952589,9952661,9952669,9952693,9952727,9952757,9952793,9952799,9952847,9952853,9952897,9952931,9952949,9952961,9952967,9952981,9952991,9953011,9953023,9953071,9953107,9953113,9953129,9953173,9953179,9953183,9953191,9953197,9953219,9953231,9953239,9953243,9953257,9953261,9953287,9953291,9953299,9953303,9953311,9953323,9953327,9953341,9953369,9953389,9953399,9953401,9953413,9953429,9953479,9953491,9953497,9953507,9953513,9953521,9953533,9953539,9953557,9953569,9953579,9953621,9953711,9953717,9953719,9953737,9953743,9953747,9953753,9953809,9953813,9953837,9953869,9953887,9953897,9953899,9953903,9953927,9953947,9953953,9954001,9954013,9954017,9954019,9954029,9954031,9954053,9954097,9954137,9954143,9954149,9954151,9954167,9954169,9954173,9954187,9954209,9954211,9954223,9954227,9954253,9954277,9954281,9954289,9954293,9954311,9954313,9954319,9954323,9954341,9954359,9954433,9954437,9954449,9954463,9954467,9954473,9954479,9954481,9954487,9954491,9954521,9954533,9954547,9954583,9954587,9954601,9954617,9954667,9954683,9954701,9954709,9954713,9954719,9954731,9954733,9954761,9954787,9954823,9954829,9954851,9954871,9954881,9954907,9954949,9954983,9954991,9955003,9955009,9955073,9955093,9955157,9955163,9955171,9955177,9955189,9955199,9955201,9955219,9955223,9955241,9955243,9955249,9955271,9955277,9955289,9955291,9955301,9955303,9955313,9955349,9955397,9955417,9955441,9955447,9955453,9955459,9955471,9955499,9955507,9955511,9955541,9955559,9955567,9955571,9955577,9955633,9955637,9955643,9955651,9955697,9955709,9955717,9955723,9955739,9955783,9955819,9955823,9955853,9955901,9955909,9955921,9955937,9955949,9956003,9956017,9956027,9956041,9956047,9956069,9956087,9956113,9956119,9956143,9956161,9956189,9956197,9956207,9956213,9956227,9956231,9956249,9956279,9956311,9956321,9956327,9956333,9956347,9956357,9956369,9956383,9956389,9956411,9956423,9956459,9956467,9956473,9956477,9956503,9956537,9956561,9956579,9956587,9956591,9956593,9956623,9956641,9956699,9956717,9956719,9956729,9956753,9956761,9956801,9956813,9956819,9956867,9956873,9956897,9956909,9956911,9956939,9956941,9956963,9956977,9956993,9957001,9957029,9957043,9957047,9957061,9957067,9957089,9957109,9957133,9957151,9957161,9957187,9957191,9957193,9957203,9957247,9957251,9957271,9957307,9957317,9957323,9957331,9957347,9957379,9957391,9957401,9957407,9957439,9957487,9957511,9957523,9957533,9957569,9957581,9957589,9957599,9957611,9957613,9957637,9957659,9957667,9957671,9957677,9957683,9957697,9957737,9957751,9957757,9957769,9957863,9957877,9957887,9957889,9957901,9957947,9957967,9957973,9957989,9958019,9958021,9958027,9958051,9958063,9958087,9958093,9958129,9958133,9958139,9958171,9958177,9958181,9958183,9958199,9958229,9958231,9958237,9958253,9958259,9958271,9958279,9958283,9958303,9958309,9958331,9958357,9958363,9958453,9958457,9958463,9958519,9958537,9958573,9958591,9958621,9958631,9958633,9958639,9958681,9958691,9958693,9958703,9958709,9958723,9958759,9958763,9958807,9958841,9958847,9958849,9958853,9958873,9958901,9958913,9958937,9958939,9958961,9958969,9958973,9958999,9959009,9959017,9959041,9959051,9959057,9959063,9959077,9959113,9959129,9959143,9959167,9959219,9959227,9959231,9959233,9959237,9959251,9959291,9959303,9959311,9959321,9959329,9959371,9959393,9959407,9959431,9959447,9959449,9959461,9959471,9959479,9959491,9959497,9959513,9959533,9959563,9959581,9959611,9959633,9959639,9959641,9959659,9959683,9959687,9959689,9959699,9959749,9959753,9959777,9959779,9959797,9959801,9959827,9959837,9959861,9959867,9959869,9959879,9959899,9959927,9959947,9959981,9959987,9960023,9960029,9960031,9960043,9960053,9960059,9960091,9960101,9960107,9960143,9960157,9960163,9960169,9960179,9960187,9960211,9960217,9960233,9960239,9960259,9960277,9960281,9960337,9960341,9960347,9960359,9960367,9960371,9960383,9960407,9960443,9960463,9960473,9960479,9960493,9960527,9960553,9960583,9960619,9960653,9960667,9960673,9960683,9960719,9960761,9960763,9960773,9960779,9960781,9960787,9960869,9960877,9960901,9960941,9960943,9960947,9960961,9960967,9960971,9960989,9961009,9961033,9961037,9961043,9961051,9961057,9961129,9961141,9961151,9961207,9961213,9961243,9961249,9961267,9961279,9961283,9961291,9961313,9961333,9961351,9961381,9961387,9961397,9961421,9961429,9961451,9961459,9961463,9961487,9961517,9961519,9961531,9961543,9961573,9961579,9961583,9961607,9961613,9961631,9961649,9961657,9961669,9961673,9961687,9961723,9961733,9961739,9961771,9961817,9961841,9961867,9961873,9961879,9961907,9961927,9961937,9961951,9961957,9961961,9961981,9962003,9962027,9962033,9962047,9962053,9962063,9962077,9962083,9962087,9962101,9962149,9962171,9962179,9962189,9962201,9962207,9962219,9962233,9962291,9962317,9962321,9962333,9962339,9962347,9962363,9962387,9962389,9962401,9962411,9962413,9962417,9962437,9962443,9962461,9962489,9962497,9962521,9962531,9962567,9962591,9962597,9962599,9962639,9962651,9962653,9962683,9962737,9962753,9962759,9962761,9962767,9962779,9962801,9962809,9962819,9962837,9962839,9962851,9962857,9962891,9962893,9962923,9962929,9962951,9962957,9962963,9962977,9962983,9962987,9962999,9963029,9963043,9963061,9963067,9963077,9963127,9963137,9963169,9963199,9963223,9963227,9963251,9963263,9963281,9963299,9963329,9963337,9963341,9963361,9963367,9963383,9963407,9963419,9963449,9963463,9963469,9963497,9963521,9963539,9963553,9963563,9963571,9963587,9963641,9963689,9963703,9963713,9963719,9963727,9963739,9963749,9963769,9963787,9963797,9963823,9963827,9963829,9963839,9963871,9963883,9963913,9963929,9963931,9963959,9963973,9963977,9963997,9964007,9964013,9964021,9964049,9964099,9964111,9964133,9964153,9964177,9964181,9964183,9964187,9964217,9964247,9964259,9964291,9964301,9964321,9964327,9964343,9964369,9964403,9964439,9964463,9964469,9964481,9964483,9964489,9964501,9964561,9964579,9964597,9964613,9964631,9964639,9964651,9964667,9964769,9964781,9964789,9964793,9964811,9964813,9964841,9964847,9964859,9964879,9964883,9964909,9964931,9964937,9964939,9964961,9964967,9964979,9965023,9965027,9965029,9965051,9965071,9965083,9965089,9965093,9965117,9965161,9965171,9965191,9965203,9965227,9965239,9965257,9965273,9965311,9965339,9965341,9965359,9965369,9965377,9965381,9965399,9965401,9965407,9965411,9965413,9965447,9965479,9965497,9965503,9965507,9965533,9965573,9965581,9965603,9965609,9965611,9965651,9965687,9965699,9965701,9965713,9965717,9965729,9965731,9965737,9965743,9965759,9965777,9965779,9965783,9965797,9965801,9965803,9965819,9965843,9965863,9965869,9965881,9965903,9965947,9965951,9965957,9965959,9966001,9966007,9966023,9966037,9966091,9966113,9966137,9966139,9966167,9966191,9966193,9966211,9966217,9966223,9966251,9966259,9966263,9966269,9966277,9966323,9966329,9966331,9966347,9966367,9966371,9966389,9966409,9966419,9966433,9966449,9966493,9966499,9966503,9966511,9966529,9966533,9966547,9966559,9966577,9966581,9966587,9966599,9966623,9966629,9966643,9966667,9966689,9966701,9966707,9966721,9966769,9966791,9966799,9966823,9966829,9966857,9966863,9966871,9966883,9966937,9966941,9966967,9966989,9966997,9967003,9967031,9967033,9967043,9967063,9967079,9967081,9967103,9967123,9967129,9967147,9967159,9967163,9967169,9967183,9967187,9967189,9967249,9967259,9967261,9967277,9967289,9967297,9967301,9967327,9967333,9967367,9967379,9967409,9967411,9967421,9967439,9967453,9967481,9967483,9967499,9967501,9967513,9967537,9967549,9967597,9967603,9967621,9967631,9967649,9967669,9967673,9967681,9967691,9967697,9967703,9967721,9967759,9967777,9967781,9967801,9967813,9967819,9967823,9967883,9967891,9967987,9968009,9968029,9968041,9968053,9968113,9968117,9968129,9968149,9968173,9968197,9968201,9968209,9968219,9968243,9968261,9968263,9968279,9968291,9968297,9968317,9968351,9968359,9968363,9968381,9968411,9968417,9968423,9968449,9968473,9968479,9968501,9968509,9968533,9968537,9968551,9968573,9968587,9968627,9968633,9968641,9968657,9968659,9968669,9968677,9968687,9968713,9968719,9968741,9968767,9968771,9968789,9968809,9968839,9968843,9968857,9968879,9968891,9968899,9968911,9968927,9968951,9968971,9969023,9969059,9969101,9969103,9969121,9969133,9969137,9969151,9969161,9969173,9969187,9969203,9969209,9969221,9969227,9969229,9969233,9969263,9969269,9969283,9969313,9969329,9969331,9969341,9969367,9969397,9969431,9969451,9969457,9969503,9969517,9969523,9969527,9969529,9969551,9969559,9969571,9969577,9969581,9969611,9969629,9969637,9969653,9969689,9969697,9969703,9969709,9969719,9969731,9969793,9969797,9969809,9969853,9969857,9969859,9969887,9969893,9969899,9969907,9969913,9969919,9969923,9969931,9969943,9969959,9970001,9970019,9970027,9970049,9970073,9970087,9970111,9970123,9970139,9970141,9970151,9970159,9970183,9970223,9970237,9970241,9970243,9970249,9970273,9970283,9970291,9970333,9970343,9970357,9970397,9970409,9970423,9970463,9970481,9970487,9970489,9970529,9970531,9970537,9970549,9970567,9970579,9970589,9970603,9970607,9970621,9970679,9970699,9970703,9970729,9970733,9970757,9970777,9970783,9970787,9970811,9970847,9970853,9970859,9970861,9970879,9970901,9970907,9970951,9970981,9971033,9971047,9971063,9971107,9971123,9971131,9971147,9971149,9971153,9971161,9971173,9971179,9971207,9971209,9971251,9971281,9971287,9971303,9971341,9971359,9971363,9971387,9971393,9971407,9971411,9971417,9971441,9971461,9971483,9971497,9971501,9971509,9971513,9971519,9971539,9971551,9971597,9971603,9971641,9971653,9971681,9971683,9971699,9971711,9971729,9971749,9971761,9971779,9971783,9971807,9971837,9971839,9971861,9971881,9971887,9971917,9971921,9971957,9971959,9971989,9971993,9972007,9972023,9972029,9972043,9972059,9972101,9972103,9972119,9972139,9972161,9972187,9972199,9972233,9972241,9972329,9972343,9972377,9972379,9972383,9972401,9972439,9972449,9972451,9972497,9972509,9972527,9972551,9972559,9972569,9972577,9972581,9972583,9972617,9972623,9972631,9972649,9972653,9972673,9972679,9972691,9972713,9972733,9972757,9972773,9972779,9972803,9972811,9972913,9972973,9972997,9973001,9973003,9973009,9973021,9973027,9973049,9973057,9973079,9973109,9973121,9973123,9973133,9973147,9973153,9973163,9973199,9973207,9973211,9973213,9973217,9973219,9973241,9973253,9973261,9973297,9973307,9973321,9973331,9973349,9973357,9973367,9973393,9973409,9973417,9973489,9973507,9973511,9973517,9973531,9973547,9973567,9973589,9973591,9973597,9973603,9973627,9973631,9973669,9973673,9973751,9973753,9973763,9973793,9973811,9973813,9973819,9973837,9973853,9973871,9973877,9973889,9973897,9973903,9973919,9973921,9973933,9973967,9973981,9974021,9974039,9974051,9974077,9974093,9974099,9974101,9974113,9974117,9974131,9974137,9974147,9974177,9974179,9974197,9974213,9974227,9974243,9974269,9974273,9974287,9974299,9974309,9974317,9974333,9974339,9974351,9974353,9974369,9974383,9974389,9974399,9974401,9974407,9974431,9974443,9974473,9974509,9974513,9974527,9974551,9974557,9974561,9974609,9974611,9974651,9974683,9974689,9974711,9974747,9974761,9974771,9974773,9974803,9974807,9974821,9974827,9974837,9974843,9974897,9974911,9974929,9974933,9974947,9974957,9974969,9974977,9974983,9975029,9975037,9975067,9975079,9975109,9975131,9975157,9975181,9975187,9975191,9975193,9975197,9975223,9975253,9975263,9975281,9975299,9975319,9975331,9975337,9975359,9975367,9975373,9975389,9975403,9975431,9975451,9975457,9975461,9975529,9975547,9975569,9975593,9975599,9975619,9975631,9975643,9975683,9975689,9975709,9975727,9975733,9975737,9975773,9975803,9975827,9975839,9975841,9975851,9975857,9975863,9975899,9975943,9975989,9976003,9976013,9976027,9976037,9976061,9976063,9976067,9976081,9976091,9976097,9976103,9976151,9976171,9976193,9976201,9976217,9976223,9976247,9976259,9976279,9976289,9976303,9976313,9976321,9976333,9976381,9976409,9976429,9976453,9976469,9976471,9976481,9976511,9976523,9976529,9976537,9976541,9976553,9976591,9976607,9976613,9976619,9976627,9976639,9976649,9976651,9976669,9976693,9976697,9976711,9976763,9976777,9976789,9976801,9976819,9976847,9976853,9976859,9976861,9976867,9976873,9976913,9976921,9976927,9976933,9976937,9977021,9977027,9977041,9977047,9977053,9977057,9977069,9977137,9977141,9977183,9977203,9977213,9977237,9977251,9977269,9977273,9977287,9977311,9977321,9977327,9977329,9977339,9977371,9977389,9977399,9977411,9977437,9977447,9977449,9977483,9977503,9977509,9977519,9977551,9977579,9977581,9977593,9977599,9977609,9977633,9977651,9977659,9977683,9977741,9977743,9977767,9977777,9977783,9977797,9977809,9977819,9977839,9977867,9977873,9977881,9977887,9977899,9977909,9977911,9977917,9977921,9977923,9977951,9977971,9977977,9977993,9977999,9978037,9978041,9978079,9978103,9978119,9978131,9978169,9978179,9978191,9978223,9978229,9978277,9978281,9978289,9978301,9978307,9978313,9978323,9978341,9978347,9978359,9978361,9978383,9978427,9978431,9978461,9978547,9978557,9978583,9978587,9978599,9978601,9978607,9978613,9978637,9978649,9978653,9978659,9978719,9978721,9978733,9978737,9978739,9978767,9978791,9978799,9978811,9978817,9978821,9978827,9978833,9978877,9978883,9978887,9978889,9978911,9978919,9978959,9978961,9978989,9979019,9979037,9979061,9979091,9979111,9979127,9979163,9979169,9979183,9979213,9979243,9979259,9979261,9979271,9979273,9979283,9979297,9979301,9979327,9979337,9979399,9979433,9979469,9979471,9979511,9979513,9979537,9979549,9979553,9979577,9979609,9979621,9979639,9979643,9979681,9979727,9979759,9979763,9979771,9979777,9979789,9979811,9979817,9979819,9979843,9979859,9979877,9979889,9979897,9979927,9979943,9979961,9979967,9979993,9980017,9980021,9980029,9980053,9980063,9980077,9980083,9980099,9980107,9980123,9980129,9980141,9980143,9980153,9980167,9980177,9980209,9980221,9980227,9980231,9980237,9980239,9980249,9980251,9980279,9980281,9980287,9980291,9980293,9980297,9980303,9980317,9980351,9980363,9980389,9980431,9980441,9980449,9980461,9980471,9980473,9980519,9980539,9980599,9980603,9980629,9980693,9980699,9980723,9980731,9980741,9980749,9980771,9980777,9980813,9980837,9980857,9980863,9980869,9980899,9980911,9980941,9980969,9980987,9981001,9981043,9981053,9981073,9981079,9981121,9981143,9981151,9981161,9981197,9981199,9981211,9981221,9981229,9981271,9981317,9981319,9981341,9981359,9981371,9981373,9981383,9981463,9981467,9981551,9981557,9981599,9981611,9981637,9981661,9981689,9981691,9981731,9981733,9981739,9981779,9981787,9981799,9981809,9981847,9981863,9981869,9981889,9981899,9981911,9981913,9981919,9981929,9981943,9982051,9982057,9982067,9982097,9982099,9982117,9982123,9982127,9982139,9982169,9982171,9982183,9982211,9982237,9982241,9982243,9982303,9982319,9982333,9982337,9982363,9982373,9982381,9982433,9982457,9982477,9982499,9982513,9982517,9982523,9982541,9982549,9982571,9982591,9982597,9982601,9982607,9982627,9982631,9982649,9982663,9982669,9982673,9982681,9982697,9982703,9982729,9982747,9982769,9982781,9982783,9982787,9982801,9982807,9982811,9982829,9982831,9982867,9982871,9982879,9982883,9982901,9982909,9982913,9982939,9982957,9982963,9982979,9982981,9983011,9983033,9983101,9983107,9983137,9983153,9983161,9983179,9983203,9983231,9983243,9983251,9983263,9983273,9983287,9983293,9983339,9983371,9983383,9983387,9983399,9983401,9983423,9983497,9983507,9983509,9983527,9983543,9983549,9983551,9983579,9983591,9983609,9983629,9983639,9983653,9983689,9983707,9983723,9983773,9983789,9983791,9983837,9983839,9983867,9983929,9983959,9983971,9983977,9983983,9983989,9983999,9984011,9984031,9984059,9984061,9984067,9984071,9984089,9984097,9984103,9984119,9984131,9984133,9984167,9984179,9984187,9984199,9984209,9984223,9984229,9984241,9984251,9984301,9984311,9984347,9984353,9984383,9984397,9984421,9984431,9984437,9984451,9984479,9984493,9984521,9984563,9984577,9984587,9984589,9984619,9984631,9984647,9984649,9984673,9984677,9984679,9984683,9984701,9984713,9984739,9984743,9984757,9984761,9984769,9984781,9984791,9984803,9984811,9984827,9984833,9984851,9984859,9984869,9984881,9984893,9984913,9984929,9984941,9984979,9984991,9985021,9985033,9985037,9985057,9985061,9985067,9985091,9985093,9985109,9985111,9985123,9985139,9985169,9985187,9985207,9985229,9985231,9985247,9985249,9985259,9985267,9985303,9985319,9985333,9985351,9985361,9985373,9985397,9985399,9985403,9985421,9985429,9985433,9985447,9985453,9985499,9985501,9985553,9985559,9985601,9985607,9985631,9985637,9985649,9985669,9985693,9985709,9985739,9985753,9985763,9985771,9985799,9985853,9985867,9985879,9985891,9985901,9985903,9985909,9985961,9985973,9985993,9986023,9986029,9986033,9986051,9986057,9986069,9986111,9986113,9986161,9986183,9986213,9986227,9986233,9986239,9986257,9986287,9986323,9986351,9986359,9986369,9986377,9986407,9986413,9986443,9986467,9986479,9986489,9986503,9986507,9986539,9986563,9986567,9986569,9986573,9986591,9986593,9986611,9986651,9986653,9986659,9986693,9986699,9986731,9986747,9986749,9986783,9986791,9986813,9986831,9986849,9986857,9986861,9986863,9986881,9986897,9986917,9986941,9986987,9986993,9987001,9987013,9987031,9987071,9987091,9987113,9987119,9987121,9987157,9987181,9987191,9987209,9987247,9987253,9987283,9987287,9987311,9987317,9987323,9987389,9987391,9987403,9987413,9987427,9987433,9987443,9987457,9987493,9987503,9987511,9987533,9987539,9987553,9987569,9987577,9987617,9987643,9987671,9987709,9987737,9987793,9987827,9987841,9987851,9987853,9987877,9987881,9987889,9987893,9987931,9987937,9987941,9987949,9987953,9987961,9987973,9987979,9988001,9988007,9988057,9988063,9988073,9988109,9988127,9988157,9988171,9988177,9988211,9988213,9988229,9988249,9988271,9988283,9988291,9988301,9988309,9988313,9988331,9988339,9988361,9988369,9988373,9988397,9988399,9988403,9988411,9988453,9988481,9988519,9988553,9988577,9988579,9988607,9988609,9988633,9988687,9988691,9988697,9988711,9988721,9988733,9988747,9988753,9988757,9988793,9988817,9988873,9988879,9988907,9988921,9988939,9988949,9988973,9988981,9988991,9989027,9989039,9989053,9989059,9989071,9989123,9989159,9989167,9989171,9989173,9989179,9989191,9989197,9989227,9989233,9989237,9989261,9989267,9989293,9989321,9989323,9989327,9989341,9989377,9989381,9989389,9989411,9989417,9989423,9989431,9989437,9989477,9989503,9989509,9989569,9989579,9989587,9989671,9989677,9989689,9989699,9989713,9989723,9989729,9989737,9989747,9989779,9989807,9989813,9989827,9989849,9989879,9989887,9989899,9989921,9989923,9989927,9989957,9990017,9990047,9990089,9990121,9990131,9990133,9990137,9990163,9990187,9990193,9990209,9990221,9990251,9990263,9990283,9990289,9990307,9990359,9990389,9990403,9990457,9990467,9990473,9990493,9990499,9990551,9990557,9990569,9990653,9990661,9990667,9990677,9990683,9990689,9990727,9990731,9990733,9990737,9990767,9990769,9990779,9990797,9990803,9990811,9990817,9990821,9990833,9990847,9990857,9990859,9990863,9990887,9990899,9990913,9990919,9990943,9990949,9990961,9990989,9990997,9991027,9991057,9991063,9991067,9991123,9991127,9991133,9991139,9991141,9991151,9991159,9991183,9991187,9991199,9991211,9991259,9991277,9991297,9991301,9991313,9991337,9991343,9991349,9991357,9991379,9991409,9991433,9991439,9991441,9991451,9991463,9991469,9991489,9991543,9991559,9991567,9991571,9991603,9991649,9991669,9991673,9991691,9991693,9991697,9991711,9991727,9991757,9991769,9991771,9991811,9991837,9991847,9991879,9991939,9991963,9991973,9991997,9992009,9992029,9992033,9992053,9992057,9992083,9992113,9992117,9992131,9992149,9992161,9992173,9992197,9992201,9992207,9992231,9992237,9992263,9992273,9992291,9992321,9992329,9992363,9992393,9992401,9992449,9992483,9992491,9992497,9992531,9992533,9992569,9992597,9992621,9992629,9992639,9992663,9992669,9992681,9992693,9992699,9992711,9992713,9992737,9992743,9992761,9992777,9992783,9992797,9992861,9992867,9992869,9992891,9992903,9992909,9992921,9992933,9992963,9993019,9993047,9993079,9993083,9993089,9993091,9993103,9993119,9993121,9993149,9993167,9993169,9993173,9993209,9993223,9993227,9993233,9993239,9993257,9993271,9993289,9993317,9993337,9993341,9993343,9993349,9993359,9993383,9993397,9993407,9993409,9993413,9993419,9993427,9993437,9993443,9993457,9993461,9993493,9993517,9993527,9993539,9993541,9993551,9993611,9993623,9993629,9993649,9993679,9993701,9993703,9993713,9993743,9993769,9993793,9993803,9993821,9993827,9993857,9993869,9993871,9993881,9993887,9993901,9993911,9993913,9993917,9993923,9993941,9993967,9993989,9994001,9994003,9994021,9994027,9994043,9994091,9994097,9994099,9994109,9994139,9994151,9994163,9994169,9994177,9994207,9994219,9994223,9994261,9994273,9994289,9994321,9994331,9994333,9994337,9994349,9994363,9994367,9994373,9994379,9994393,9994417,9994421,9994427,9994441,9994451,9994469,9994483,9994499,9994507,9994553,9994559,9994573,9994603,9994613,9994631,9994669,9994681,9994697,9994709,9994717,9994727,9994739,9994753,9994757,9994769,9994799,9994801,9994807,9994813,9994837,9994867,9994871,9994913,9994951,9995003,9995009,9995023,9995039,9995057,9995077,9995093,9995101,9995107,9995119,9995129,9995147,9995149,9995213,9995239,9995243,9995257,9995329,9995333,9995341,9995347,9995369,9995407,9995411,9995413,9995437,9995477,9995483,9995497,9995519,9995527,9995533,9995549,9995563,9995567,9995569,9995581,9995597,9995599,9995611,9995617,9995647,9995659,9995669,9995683,9995701,9995717,9995723,9995743,9995801,9995827,9995831,9995837,9995849,9995861,9995891,9995903,9995911,9995927,9995971,9995987,9995989,9996001,9996011,9996059,9996067,9996073,9996089,9996137,9996139,9996149,9996157,9996209,9996211,9996241,9996247,9996263,9996313,9996359,9996361,9996373,9996419,9996457,9996461,9996487,9996491,9996509,9996517,9996523,9996541,9996557,9996583,9996589,9996593,9996599,9996617,9996631,9996647,9996659,9996667,9996673,9996703,9996709,9996719,9996737,9996751,9996757,9996781,9996803,9996809,9996817,9996823,9996829,9996859,9996887,9996929,9996937,9996949,9996979,9996991,9997007,9997033,9997049,9997063,9997087,9997093,9997109,9997123,9997129,9997133,9997177,9997189,9997201,9997219,9997237,9997291,9997303,9997319,9997321,9997327,9997333,9997349,9997357,9997367,9997381,9997397,9997441,9997451,9997483,9997517,9997523,9997573,9997577,9997579,9997583,9997597,9997601,9997613,9997621,9997627,9997643,9997661,9997697,9997703,9997711,9997739,9997747,9997753,9997777,9997783,9997787,9997817,9997829,9997831,9997859,9997873,9997877,9997879,9997913,9997927,9997937,9997951,9997957,9997969,9997987,9997991,9997997,9998017,9998033,9998099,9998117,9998119,9998129,9998141,9998143,9998147,9998173,9998179,9998201,9998203,9998207,9998239,9998249,9998273,9998279,9998281,9998309,9998321,9998323,9998333,9998377,9998381,9998393,9998413,9998423,9998441,9998447,9998459,9998479,9998539,9998543,9998557,9998561,9998581,9998587,9998603,9998623,9998633,9998641,9998689,9998699,9998701,9998719,9998741,9998743,9998749,9998753,9998777,9998797,9998801,9998809,9998851,9998861,9998867,9998887,9998893,9998903,9998929,9998969,9998971,9998977,9999047,9999049,9999053,9999071,9999083,9999161,9999163,9999167,9999193,9999217,9999221,9999233,9999271,9999277,9999289,9999299,9999317,9999337,9999347,9999397,9999401,9999419,9999433,9999463,9999469,9999481,9999511,9999533,9999593,9999601,9999637,9999653,9999659,9999667,9999677,9999713,9999739,9999749,9999761,9999823,9999863,9999877,9999883,9999889,9999901,9999907,9999929,9999931,9999937,9999943,9999971,9999973,9999991
		]

		#return 最小公倍数
		def lcm(a,b):
			return (a*b)//gcd(a,b)

		#1.1大きな素数p,qを作成し、n=p,qとする
		p = prime_list[random.randint(0,len(prime_list)-1)]
		q = prime_list[random.randint(0,len(prime_list)-1)]
		n = p*q
		self.n = hex(n)[2:]

		#1.2ガウスのv数Φ(n)=(p-1)(q-1)と互いに素な整数eをQめる
		l = (p-1)*(q-1)
		i = 2
		while 1:
			if gcd(i, l)==1:
				e = i
				break
			i+=1

		#1.3(ed)mod(p-1)(q-1)==1となるdをQめる
		i = 1
		while 1:
			if (l*i+1)%e==0:
				d = (l*i+1)//e
				break
			i+=1

		self.e = hex(e)[2:]
		self.d = hex(d)[2:]


	def enc(self,target,key="-1"):
		#2暗号化
		if key=="-1":
			print(-1)
			public_key, product = int(self.e,16), int(self.n,16)
		else:
			public_key, product = int(key[0],16), int(key[1],16)
		targetToAscii = [ord(c) for c in target]
		asciiToEncryptedint = [pow(i, public_key, product) for i in targetToAscii]
		encrypted_target = ".".join(hex(i)[2:] for i in asciiToEncryptedint)
		return encrypted_target


	def dec(self,target,key="-1"):
		#3秃
		if key=="-1":
			print(-1)
			private_key, product = int(self.d,16), int(self.n,16)
		else:
			private_key, product = int(key[0],16), int(key[1],16)
		targetToDec = [int(i, 16) for i in target.split(".")]
		decToAscii = [pow(i, private_key, product) for i in targetToDec]
		asciiToText = [chr(i) for i in decToAscii]
		text = "".join(asciiToText)
		return text

	def product(self):
		return self.n

	def pub_key(self):
		return (self.e, self.product())

	def pri_key(self):
		return (self.d, self.product())


	def keys(self):
		ans = {
			"public_key" : self.e,
			"private_key": self.d,
			"product"    : self.n
		}
		return ans
		